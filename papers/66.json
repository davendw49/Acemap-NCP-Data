{"date": "2020/02/12", "journal": "biorxiv", "authors": "Jonas Pfab, Dong Si", "title": "DeepTracer: Predicting Backbone Atomic Structure from High Resolution Cryo-EM Density Maps of Protein Complexes", "type": "preprint article", "abstract": "Motivation: Accurately determining the atomic structure of proteins represents a fundamental problem in the field of structural bioinformatics. A solution would be significant as protein structure information could be utilized in the medical field, e.g. in the development of vaccines for new viruses. This paper focuses on predicting the protein structure based on 3D images of the proteins captured through cryogenic electron microscopes (cryo-EM). A fully automated computationally efficient protein structure prediction method would be particularly beneficial in the field of cryo-EM as the technology allows researchers to photograph multiple large protein complexes in a single study, which means that a fast prediction method could allow for a high throughput of derived protein structures. We present a deep learning approach, DeepTracer, for predicting locations of the backbone atoms, secondary structure elements, and the amino acid types. In order to connect the predicted amino acids into chains, we applied a modified traveling salesman algorithm. Results: We trained our deep learning model on experimental cryo-EM density maps and tested it on a set of 50 density maps. We found that our new approach predicted protein structures with an average RMSD value of 1.18 and a coverage of 87.5%. Furthermore, we detected secondary structure information for 87.2% of amino acids correctly. We also showed preliminarily that 25.2% of amino acid types could be predicted directly from the 3D cryo-EM density map, considering 20 different types in total. Finally, we noted that the prediction runtime of DeepTracer is significantly improved compared to other methods. It predicts a large protein complex structure of more than 30,000 amino acids in only 2 hours. Availability: The repository of this project will be published. Contact: dongsi@uw.edu Supplementary information: Supplementary data will be available at Bioinformatics online.", "text": "        As a consequence, knowledge about the structure of a protein helps to gaina deeper understanding about its behavior. This can be particularly useful,e.g., in the development of new vaccines and drugs for new viruses suchas Nove        There are two main approaches to predict protein structures: homologymodeling and de novo structure prediction. They differ in such thathomology modeling requires structural knowledge about a homologousprotein for its prediction while de novo methods do not. This limits theapplication range of homology modeling, since homologues proteins mustbe obtained first before making predictions, which is why we aim at themore challenging de novo structure prediction. Traditionally, research onde novo protein structure prediction was focused on inferring the 3Dstructure through the protein\u2019s amino acid sequence [8]. This approach isbeneficial as the determination of the sequence is relatively straightforward.Methods that follow this approach either use geometric calculations toestimate the protein structure [9], [10], or they use deep learning techniques,such as Google\u2019s AlphaFold [11]. While these methodologies have led toimpressive results, their accuracy is naturally limited as the amino acidsequence does not completely contain the protein\u2019s structural information,especially for very large protein complexes [12].Throughout the last decade, technological advancements in cryogenicelectron microscopy (cryo-EM) have provided a new approach to solvethe structure determination problem. Cryo-EM allows researchers tocapture 3D images of large protein complexes by cooling them to cryogenictemperatures without the need of a costly crystallization of the protein[13]. In recent years the resolution of these images has increased to anearatomic level which led to an exponential gain in popularity of thetechnology [14]. A 3D image captured through cryo-EM is an electron densitymap (see Fig 1). It represents the volume of the protein complex througha 3D grid of voxels. Each voxel stores the electron density value, meaningthe probability that an electron is present, for its location. Latestdevelopments in the field of cryo-EM have allowed researchers to capture manyhigh-resolution density maps from large protein complexes in the courseof a single study [15]. This makes the ability to predict protein structuresfrom cryo-EM maps fully automatically even more significant as it allowsfor a very high throughput of protein structures derived from cryo-EMmaps.Fig 1. EMD-6272 (rotavirus VP6) Density Map (left) and its corresponding solvedstructure PDB-3j9s depicted in ribbon (center) and backbone view (right).The structure of a protein can be estimated from its density map,intuitively by placing the amino acids in such way that the resulting structurefits well into the density map. While this sounds like a simple task itbecomes very challenging due to lower local resolutions as well as noisecreated through errors in the cryo-EM. Currently, there are several existingmethods that perform protein structure predictions based on cryo-EM datasuch as Phenix and Rosetta [16], [17]. They both use conventionalalgorithms to place and connect the amino acids of the protein. However, theyoften struggle to identify amino acids as such and, therefore, tend to havea low coverage on large protein complex [18]. Furthermore, their longruntime is a problem. The prediction of small density maps can take up toseveral days rendering the method practically useless for the prediction oflarge proteins. The C-CNN method, another protein structure predictionapplication which utilizes deep learning techniques, achieves better resultsin terms of coverage [18]. However, it requires some manual input and theruntime could be further improved. Additionally, it predicts the locationof C\u03b1 atoms without information about their amino acid type. Therefore,we present the DeepTracer, a new fully automated method for theprediction of protein structures from cryo-EM density maps, with the goal ofimproving the runtime by applying a 3D U-Net in combination with amodified travelling salesman algorithm and having the ability ofrecognizing the amino acid type from 3D cryo-EM density maps.The functionality of our new DeepTracer is explained in the Methodssection. In the Results section, the DeepTracer is applied on a test set of30 density maps in order to assess and compare its accuracy with othermethods. The implications of the project and possible future work isexamined in Discussion. Finally, we recapture our findings in the Conclusionsection.2The full prediction pipeline of the DeepTracer includes many differentsteps. In this section we will look at the major ones and explain how theycreate a protein structure based of a density map. We begin by looking atthe 3D U-Net which predicts confidence maps that show where e.g. atomsmight be or where which secondary structure is likely to be present. Next,we will examine how the DeepTracer uses this information to place theactual amino acids, as well as how it connects them into chains to formthe protein structure. Finally, we discuss how secondary structureinformation can be used to refine predicted \u03b1-helices.The deep learning model represents the central entity in the structureprediction. Its job is to predict not only the locations of amino acids but alsosecondary structure positions and amino acid types. To explain itsrealization, we start by looking at its architecture. Then, we move on to the datacollection and preprocessing steps and finally describe the model\u2019straining process.The U-Net model gets its name from the U-shape of its architecturewhich is optimized for segmentation tasks on medical images [19]. Thedetailed architecture of the model can be seen in Fig 2. The cryo-EMdensity maps are fed to the 64# input layer. The output layer has the same 64#shape with N different channels. The number of channels depends herebyon what the U-Net is predicting (e.g. the secondary structure U-Net hasthree channels for loops, sheets, and helices).Fig 2. Architecture of the U-Net as used by the DeepTracer. The blue boxes show theoutput maps of the different layers where the dimensions of the maps are depicted on theleft and the number of channels is depicted on top.DeepTracerAs mentioned above, the U-Net should predict multiple things, includingthe amino acid positions, secondary structure elements, as well as theamino acid types. Therefore, the model consists of three parallel U-Netsas shown in Fig 3. The first one is responsible for predicting the aminoacid positions. As the Ca atom of each amino acid is central to its positionwe can reduce this task to only predicting the Ca atoms of the proteinstructure. Additionally, this U-Net also predicts the backbone location ofthe protein, which is defined as the position of all Ca, C, and N atoms ofthe structure. This prediction will later on be useful in order to connect theamino acids into chains. Thus, the output of the C\u03b1 atoms U-Net has twochannels. The second U-Net is responsible for predicting the secondarystructure elements and, therefore, its output has three channels, one foreach structural element (\u03b1-helix, loop, and sheet). Finally, the third U-Netis tasked to predict the amino acid types of the protein structure. Sincethere are 20 different types of amino acids occurring in nature its outputhas the same number of channels. In Fig 4 we can see an example outputfor each of the U-Nets with the density map from Fig 1 as input.Fig 3. Architecture of the deep learning model, which includes three parallel U-Nets.The blue boxes show the input and output maps of the model, with their dimensions notedto the left and the number of channels marked below.Fig 4. Example output confidence maps of the model for the EMD-6272 density map.(A) and (B) are both the output of the C\u03b1 atom U-Net and show the C\u03b1 atom locations (A)as well as the backbone of the protein (B). (C) shows the output of the secondary structureU-Net with a-helices in yellow, loops in purple, and sheets in red. In (D) we can see theoutput of the amino acid type U-Net where each color represents a different type of aminoacid.Now that we have looked at the architecture of the model, we can continuewith the data collection. In order for the deep learning model to learncommon noises and errors present in cryo-EM density maps we decided totrain the U-Net using experimental data rather than density mapssimulated from solved structures such as [18]. We downloaded the densitymaps from the EMDataResource website [20] in combination with theirsolved protein structures which function as the ground truth for thetraining process. We obtained the solved structures from the RCSB ProteinData Bank [21]. Since this paper is focused on high resolution maps, weonly used density maps with a resolution of 4\u00c5 or better. In total we used411 different density maps to build the training and validation sets.The preprocessing steps can be split into preparing the cryo-EM densitymaps and creating the different labels based on the solved structures. Forthe experimental density maps we have to make sure that the voxel sizeequals one, meaning that every voxel measures 1\u00c5. Furthermore, we needto adjust the dimensions of the map to the 64# input dimensions of themodel as seen in Fig 2. This is done by splitting the maps into several 64#big cubes. In order to avoid errors at the borders of the cubes we overlaythem partly such that we only use the 50# center voxels of each cube toreconstruct the output maps to the original dimensions of the density map.By splitting the 411 density maps that we collected in this manner, weretrieve 16,070 training examples. To create the labels that the model canbe trained on, we use the solved structure to create masks by filtering outthe corresponding atoms and setting all voxels within a certain distance tothose atoms to one. For the C\u03b1 mask we filter only the C\u03b1 atoms of theprotein structure and set all directly neighboring voxels around them toone. The backbone mask is created similarly except that we use all C\u03b1, C,and N atoms. To generate the secondary structure masks, we filter out allatoms for each structural element and set all voxels within a distance oftwo around each filtered atom to one. Finally, to create the amino acid typemasks we filter out all atoms for each amino acid type and set allneighboring voxels to one for each atom. In total this gives us 25 different masksfor each training example (C\u03b1 mask, backbone mask, three secondarystructure masks, and 20 amino acid type masks).As mentioned above, the determining factor for the position of an aminoacid is the position of its C\u03b1 atom. In order to place the C\u03b1 atoms in the3D space we use the Ca atoms confidence map as well as the backboneconfidence map. The backbone map is used to identify different chainsand the Ca atoms map to find the locations of the Ca atom.Before we place any C\u03b1 atoms, we try to identify separate chains in theprotein structure. This will help us later when connecting the atoms andimproves the runtime of the connection process. In order to discern thechains, we identify connected areas of voxels that have a confidence valueof 0.5 or higher. An example of the chains identified from a backboneprediction can be seen in Fig 5. We can now mask all other confidencemaps with each chain area that we identified in order to continue theprediction independently for all chains.Fig 5. Backbone prediction of EMD-0478 density map (human TPC2 channel) (humanTPC2 channel) with identified chains marked in different colors.The last prediction step is responsible for refining modelled \u03b1-helices.Here for, we can exploit the fact that the shape of an \u03b1-helix has a generaldefinition which is valid across proteins [23]. Since the U-Net predicts theconfidence of secondary structure elements, as shown in Fig 4, we knowwhich amino acids belong to an \u03b1-helix based on the confidence of theirregion in space. We combine this knowledge of \u03b1-helix locations and theirshape attributes in order to adjust the appropriate C\u03b1 atoms to better fit theshape of a natural \u03b1-helix structure.For an \u03b1-helix which centers around the z-axis, we can use Equation 2to model its shape where the variables s and r represent the initial shift androtation of the helix. The values 2.11 and 1.149 are constants that definethe radius and pitch of the helix to best match those of an \u03b1-helix. = .  \u00d7 (.  \u00d7 ) \u2212  +  = .  \u00d7 (.  \u00d7 ) \u2212  +  (2)=Equation 2 however, cannot be used to describe an \u03b1-helix which doesnot center around the z-axis or whose shape is not a straight cylinder. Sincethis is the case for most \u03b1-helices, it is necessary to adjust the equation insuch way that it will address these issues. With the aim of doing so, wefirst locate the screw axis, the center line around which the helix windsitself, for each \u03b1-helix. This is achieved by calculating the centroid ofconsecutive intervals of the \u03b1-helix and then connecting them to approximatethe true curve. An example of an \u03b1-helix and its calculated screw axis canbe seen in Fig 7.Next, we place the actual C\u03b1 atoms in two simple steps, using themasked C\u03b1 confidence maps. First, we find the initial atom locations bycalculating local minima in the confidence map within a neighborhood ofone voxel and a minimum value of 0.6. The value of 0.6 was chosen aftersome testing as it produced the most accurate results. This gives us a listof voxel indices. However, as atoms can have floating point coordinates,we try to improve this initial location by calculating the center of mass for3# cubes around each local minimum. The resulting values are used as thecoordinates for the C\u03b1 atoms of the protein structure.In this prediction step, we use the predicted C\u03b1 atoms and connect theminto chains using a travelling salesman algorithm (TSP) [22]. However,instead of using the Euclidean distances between atoms to measure thetotal length of the path, we use a custom confidence score that expresseshow confident we are that two atoms share a connection. The task of theTSP algorithm is then to connect the atoms into chains such that theymaximize the sum of all confidence scores.The calculation of the confidence score between two atoms takes twofactors into consideration: The Euclidean distance between them, as wellas the average confidence of voxels that lay in between the atoms in thebackbone prediction. Let (, , ) be the normal probability densityfunction at  with mean  and standard deviation , /,0 the Euclideandistance between atoms a and b, and /,0 the average backbone confidencebetween atoms a and b. We define the confidence score as shown inequation 1. The constant 3.8 was chosen as the mean for the distances betweentwo atoms as this corresponds to the average distance found in nature. Thestandard deviation parameters of 5 and 0.3 where selected based on testruns. They were intentionally chosen higher than in the distribution foundin solved structures, in order to cut some slack for prediction inaccuracies.8,,.,>(, ) = 6(.,.,) \u00d78(,,,,,..)> , , < , otherwiseIn order to apply the TSP algorithm, we also need to specify a start/endpoint. However, we do not know yet at which atom the chain will start andend. Therefore, we add a new atom that is connected to every other atomwith a confidence of 1. This atom is then specified as the start/end andlater on removed from the actual chain. An example of the application ofthe TSP on a list of C\u03b1 atoms can be seen in Fig 6.Fig 6. Predicted C\u03b1 atoms for EMD-4054 density map (major capsid protein) (majorcapsid protein) in blue before (left) and after (right) the backbone tracing stepcompared to the true structure in pink.1https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html(1)Fig 7. \u03b1-Helix extracted from the backbone prediction of the EMD-8515 density mapin tan color and its screw axis in teal color.Now that we know the location and shape of the screw axis for the\u03b1helix, we need to incorporate this information into Equation 2. This isachieved by interpreting t as the distance that we travelled on the screwaxis and use the unit direction vector of the screw axis at a certain point tas the new z axis. Next, we can find the new y-axis by calculating the crossproduct of the x-axis and the new z-axis and then normalizing it. Finally,we can get the new x-axis by calculating the cross product of the new zand y-axis and normalizing it again. By concatenating the three new axeswe can get a rotation matrix RM with which we can calculate the point ofthe \u03b1-helix for any value t as shown in Equation 3.2.11 \u00d7 (1.149 \u00d7 ) \u2212  + \u03b1-helix() = screw-axis() + RM a 2.11 \u00d7 (1.149 \u00d7 ) \u2212  + i (3)0Now, we need to know the values t at which we have to insert C\u03b1 atoms.Since we know that an \u03b1-helix has a rise of 1.5\u00c5 per residue [23] we canincrease t in steps of 1.5 and add a new C\u03b1 atom at \u03b1-helix(t).In the final step we minimize the average distance from the C\u03b1 atomsof the refined \u03b1-helix to the C\u03b1 atoms of the original prediction. This isdone by applying a minimization algorithm1 over the variables s and r totry different initial shifts and rotations. The final results of the \u03b1-helixrefinement step are shown in Fig 8.Fig 8. \u03b1-Helix extracted from the prediction of the EMD-8515 density map. (Top)Original prediction before the helix-refinement step. (Center) \u03b1-Helix after the refinement.(Bottom) Direct comparison of original prediction in tan color, refined prediction colored inteal, and the solved structure (PDB-5u70) in pink color.ResultsIn order to gain a better understanding about the performance of theDeepTracer we will apply it to a test set of 30 experimental density maps andevaluate the predictions using different metrics. Additionally, we willcompare its performance against Phenix, as well as the C-CNN backboneprediction method.We measure the accuracy of a predicted protein structure by comparingit to its corresponding solved structure using the following metrics. First,the root-mean-square deviation (RMSD) value describes the averagedistance between atoms of the predicted and solved protein structure. Thisgives us an idea how close the predicted atoms are to their correct counterparts. However, this does not give us any information about the percentageof atoms that we have correctly identified. For this purpose, we calculatethe coverage value, which expresses the percentage of atoms in the solvedstructure that lay within 3\u00c5 of a predicted atom. Finally, we evaluate thefalse-positive percentage which is the number of atoms that were predictedfurther than 3\u00c5 from any atom in the solved structure, divided by the totalnumber of predicted atoms. In addition to the metrics that we use tocompare the other methods to the DeepTracer, we also calculate the secondarystructure and amino acid type accuracy. We cannot evaluate these for theother methods as they utilize the U-Net confidence maps rather than thepredicted protein structure. The secondary structure accuracy is defined asthe percentage of atoms from the solved structure whose secondarystructure type equals the one predicted by the U-Net for its location. The aminoacid type accuracy is calculated in the same way. In Table 1, we can seethe test results for all 30 density maps.3 Percentage of atoms that were predicted further than 3A away from anyatoms in the solved structure4 Percentage of atoms from the solved structure that lay within 1A of apredicted atom5 Percentage of atoms from the solved structure for which the U-Netcorrectly predicted the secondary structure6 Percentage of atoms from the solved structure for which the U-Netcorrectly predicted the amino acid type (missing entries indicate that thesolved structure did not contain amino acid type information)In order to get a better idea of the implications of the results we take acloser look at the protein structures predicted by the DeepTracer andPhenix for the EMD-6272 density map (rotavirus VP6) and compare them tothe solved structure (see Fig 9). We can see in the highlighted areas thatthe DeepTracer incorrectly connected amino acids in two cases. However,all predicted amino acids are still connected as a single chain. Incomparison to that the prediction of Phenix is fragmented into multiple chains.Furthermore, amino acids appear to be missing from the predictionexplaining the coverage difference of 8.1% (see Table 1). The predictedsecondary structure elements in the Phenix prediction, particularly for sheets,appear also much less accurate than the ones made by the DeepTracer.Another noteworthy observation, although not a fair comparison as Phenixpredicts more than just the backbone structure, is that the predictionruntime of Phenix for the EMD-6272 map was 1 hour and 45 minuteswhile the runtime of the DeepTracer for the same map was 40 seconds.24:00:006:00:001:30:000:22:300:05:370:01:240:00:2101000200030004000500060007000Fig 9. Solved PDB-3j9s protein structure (blue) and predictions by the DeepTracer(green) and Phenix (yellow) for EMD-6272 density map (rotavirus VP6). Highlightedareas show where the DeepTracer connected the amino acids incorrectly.As mentioned in the introduction, a central goal of the DeepTracer was toimprove the runtime of protein structure predictions. This makes itpossible to predict ever larger density maps which allows for a more versatileapplication of the method. In order to compare the runtime of theDeepTracer with the C-CNN method we measure the execution time of eachmethod for the prediction of multiple density maps. A scatter plot of themeasured times is depicted in Fig 10.Fig 10. Scatter plot of prediction runtimes (y-axis) of the DeepTracer (blue) and theC-CNN method (red) for various density maps against the number of predicted atoms(x-axis). In order to see the runtimes more clearly, we use a logarithmic scale with a baseof 4.In order to evaluate the runtime of the DeepTracer for larger proteins wepredicted the EMD-4903 density map (echovirus 1 intact particle). Thenumber of predicted atoms for this map was 32,446. The execution of theend-to-end prediction pipeline of the DeepTracer took only two hours. Asa point of comparison, the expected runtime of the C-CNN method for thesame density map is more than 5 days assuming the trend in Fig 11continues for larger proteins. The original density map next to the predictionof the DeepTracer can be seen in Fig 11.Fig 11. Density map (left) of EMD-4903 (echovirus 1 intact particle) and its predictedprotein structure (right), containing more than 30,000 atoms.In addition to the location and secondary structure of amino acids, theDeepTracer also predicts their types. As reported in Table 1 we assignedthe correct type out of the 20 possible amino acid types with an accuracyof 25.2%. In order to get a better idea of what that result means we look ata specific structure prediction. For the EMD-6272 density map, wepredicted the correct amino acid type for 31.49% of amino acids. Note thatthis is predicted solely from 3D map without using any geneticinformation of the protein. In Fig 12 we can see an extract of the amino acidsequence as predicted by the DeepTracer, compared to the sequence of thesolved structure. The sequence was created by walking along the predictedchain of amino acids and noting down the type of each amino acid. Thepredicted amino acids from 3D could potentially be utilized for thereference of future full-atom structure prediction.ASP GLU ALA ALA THR LEU PHE PRO TRP TRP ASN ASP ARG GLU GLUPHE PHE TYR TYR PHE SER SER ASN TRP PRO PRO ASN HIS PRO ARGASP SER THR VAL ASN ILE ARG ARG PRO LEU ALA ASN ALA SER VALTHR VAL VAL PRO THR LEU THR ILE LYS ILE THR SER ALA VAL THRASN ASP PRO VAL THR SER LYS PRO ASN ILE MET ILE ALA THR VALGLU GLU THR ILE ARG SER HIS ALA VAL THR ILE ALA THR VAL PHEPRO PRO PRO PHE LYS TRP ASN GLU LEU VAL SER TYR PHE TYR ARGARG GLU GLU LEU LEU GLN ARG VAL TYR VAL VAL ALA SER LEU ARGALA GLU ILE PRO ARG ARG ARGPRO ALA VAL ALA ALA LEU PHE PRO ASN ALA GLN PRO PHE GLU HISHIS HIS TYR SER CYS ALA ILE ASN ALA ALA ASN THR GLN GLN PHEGLU HIS ILE VAL GLN LEU ARG ARG VAL LEU THR THR ALA THR ILETHR LEU LEU PRO ASP LEU THR LEU ARG ILE GLU SER ALA VAL CYSGLU SER VAL LEU ALA ASP ALA SER GLU THR MET LEU ALA ASN VALTHR SER VAL ARG GLN GLU TYR ALA ILE PRO VAL GLY PRO VAL PHEPRO PRO GLY MET ASN TRP THR ASP LEU ILE ASN TYR TYR SER ARGARG GLU ASP ASN LEU GLN ARG VAL PHE THR VAL ALA SER ILE ARGSER MET LEU VAL LYS LYS LYSFig 12. Extract of the amino acid sequence predicted by the DeepTracer for theEMD6272 density map (top) compared to the sequence of the solved structure PDB-3j9s(bottom). Correctly predicted amino acids are highlighted in red.3The final goal of the DeepTracer is to accurately predict the completeprotein structure from high resolution cryo-EM density maps. In this sectionwe evaluate how close we are to this goal, based on the results presentedin the previous section, as well as discuss what further work is necessary.When looking at the results reported in Table 1, we can note a coupleof things. First, we see that the percentage of false positives predicted bythe DeepTracer has increased by 1.9% compared to the C-CNN method.This can be explained through the manual thresholding which reducesnoises in the experimental density maps and is utilized in the C-CNNmethod. However, considering that this step introduces manual effort tothe prediction process, this is an acceptable concession as our new methodis fully automated. Next, we see that the coverage percentage of theDeepTracer beats Phenix by over 20%. However, it still lacks behind theCCNN method by 3%. On the contrary, Phenix performs best for RMSD,beating the DeepTracer by 0.08 and the C-CNN method by 0.09. If wecompare the DeepTracer to Phenix based on these two metrics, we can seethat the coverage improvements significantly outweigh the smalldeterioration in RMSD. However, compared to the C-CNN method there is nosignificant difference regarding the RMSD and coverage. As mentionedin the introduction, we wanted to focus not only on the predictionaccuracy, but also on the runtime of the predictions. And here we can discernimmense differences. For the prediction of smaller structures. the C-CNNmethod took at least 20 minutes while the DeepTracer ran smallpredictions in a matter of seconds. However, the bigger implications lay in theprediction of larger proteins. For around 6000 atoms the C-CNN methodtook over 24 hours to finish, whereas the DeepTracer only needed around20 minutes, for some even less than 5 minutes. Particularly, the trendlineis interesting as it gives us an idea of how the methods will behave forvery large proteins. The C-CNN trendline seems almost linear above 2000predicted proteins and the runtime seems to quadruple when 6000predicted atoms are reached. If this trend continues then we could expect a75-fold runtime increase in order to predict 100,000 atoms. The runtimesof DeepTracer, however, seem to remain flat once a certain number ofatoms is reached which would mean that very large proteins could bepredicted within a reasonable runtime. This can be explained by the chainidentification step that is applied before the prediction of any atom. Whilelarger proteins consist of more chains than smaller ones, the number ofatoms in the chains does not necessarily grow. As each chain is processedseparately this means that if the chain lengths remain constant and onlythe number of chains gets larger the runtime grows linearly with thenumber of chains.In addition to the false-positive percentage, the coverage, and theRMSD we also calculated the secondary structure and amino acid typeaccuracy for the DeepTracer using the confidence maps predicted byUNet. We can see that the secondary structure prediction performs well withan average accuracy of 81.72%. We also show that deep learning coulddiscern different types of amino acids based on the density maps.Particularly, as this is only the preliminary stage of predicting amino acid typedirectly from 3D cryo-EM density map. It gives promise for futureimprovements through a more elaborate training of the U-Net with moredata. Furthermore, we plan to include the amino acid sequence as an inputparameter, so that we can map the predicted sequence with the inputsequence and refine our prediction. For this sequence mapping work, anamino acid type prediction accuracy of around 30% from 3D could bealready helpful. Particularly, as we can see from Fig 12 that the U-Net tendsto correctly predict the type of consecutive amino acids, likely due to highlocal resolutions. As it is very unlikely that this happens by chance, wecan use this information to map the input sequence to our 3D backboneatom and amino acids prediction.4In this paper, we presented the DeepTracer, a fully automated tool whichcan accurately predict backbone protein structures based on 3D cryo-EMdensity maps. In terms of accuracy, we were able to outperform theestablished structure prediction method Phenix by over 20% in structurecoverage with only a slight RMSD increase of 0.08. Compared to the deeplearning-based C-CNN method we achieved a slightly better RMSD by amargin of 0.01 with a slightly decreased coverage of 3%. In contrast withthe C-CNN method, this fully automated method requires no manually setparameters. And the vastly reduced runtime allows us to predict proteinstructures within minutes instead of days. This is significant, as it allowsthe researchers to apply the DeepTracer on very large density maps andexpect results maximally within a couple of hours. Furthermore, weachieved preliminary results in the amino acid type prediction from 3Dwith an accuracy of 25.2%. This gives promise to the incorporation ofamino acid sequence into the prediction pipeline. Since the predictedamino acids from 3D could potentially be utilized for the reference offuture full-atom structure prediction. In the future, we expect to use theamino acid type information to extend the functionality of the DeepTracersuch that it can predict the protein full atom structure, including the sidechains of the amino acids.", "ref_list": [[], [""], ["The Anatomy and Taxonomy of Protein Structure,\u201d in Advances in Protein Chemistry"], ["\u201cWuhan coronavirus 2019-nCoV - what we can find out on a structural bioinformatics level"], [""], ["\u201cEvolution of the novel coronavirus from the ongoing Wuhan outbreak and modeling of its spike protein for risk of human transmission,\u201d Sci. CHINA Life Sci"], [""], ["and"], [""], ["\u201cApplication of the Three-Dimensional Structures of Protein Target Molecules in Structure-Based Drug Design | Journal of Medicinal Chemistry"], ["Protein sequencing by tandem mass spectrometry"], ["GOR method for predicting protein secondary structure from amino acid sequence,\u201d in Methods in Enzymology"], [""], ["Improved protein structure prediction using potentials from deep learning"], ["and"], [""], [""], [""], ["Cryo-EM structures of Helicobacter pylori vacuolating cytotoxin A oligomeric assemblies at near-atomic resolution"], [""], ["Protein Structure Prediction Using Rosetta,\u201d in Methods in Enzymology"], ["Deep Learning to Predict Protein Backbone Structure from High-Resolution Cryo-EM Density Maps"], ["Convolutional Networks for Biomedical Image Segmentation"], [""], [""], [""], ["Langel-Cravatt-Graslund-von-"], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []], "ref_authors": [[], ["Garland Science"], ["J. S. Richardson", "J. T. C. B. Anfinsen", "F. M. Edsall", "Richards"], [], [], ["X. Xu", "Jan"], ["L. E. Gralinski", "V. D. Menachery", "Feb"], ["G. Corradin", "V. Villard", "A. V. Kajava"], [], [], ["Hauer"], ["J. Garnier", "J.-F. Gibrat", "B. Robson"], ["Mol. Biol."], ["A. W. Senior"], ["B. Contreras-Moreira", "I. Ezkurdia", "M. L. Tress", "A. Valencia"], ["E. Nogales"], ["A. Merk", "\u201cBreaking"], [], ["K. Zhang"], ["D Biol"], ["C. A. Rohl", "C. E. M. Strauss", "D. K. M. S. Misura", "Baker"], ["S. A. Moritz", "\u201c", "Mar"], ["O. Ronneberger", "P. Fischer", "T. Brox"], [], ["R. P. D. Bank"], [], ["Heijne-"], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []], "fir_para": "\n        As a consequence, knowledge about the structure of a protein helps to gain\na deeper understanding about its behavior. This can be particularly useful,\ne.g., in the development of new vaccines and drugs for new viruses such\nas Nove\n        ", "one_words_summarize": "As a consequence, knowledge about the structure of a protein helps to gaina deeper understanding about its behavior. They differ in such thathomology modeling requires structural knowledge about a homologousprotein for its prediction while de novo methods do not. It represents the volume of the protein complex througha 3D grid of voxels. Each voxel stores the electron density value, meaningthe probability that an electron is present, for its location. However, it requires some manual input and theruntime could be further improved. The functionality of our new DeepTracer is explained in the Methodssection. The implications of the project and possible future work isexamined in Discussion. Next,we will examine how the DeepTracer uses this information to place theactual amino acids, as well as how it connects them into chains to formthe protein structure. The deep learning model represents the central entity in the structureprediction. Its job is to predict not only the locations of amino acids but alsosecondary structure positions and amino acid types. To explain itsrealization, we start by looking at its architecture. As the Ca atom of each amino acid is central to its positionwe can reduce this task to only predicting the Ca atoms of the proteinstructure. This prediction will later on be useful in order to connect theamino acids into chains. Since this paper is focused on high resolution maps, weonly used density maps with a resolution of 4\u00c5 or better. Forthe experimental density maps we have to make sure that the voxel sizeequals one, meaning that every voxel measures 1\u00c5. Furthermore, we needto adjust the dimensions of the map to the 64# input dimensions of themodel as seen in Fig 2. By splitting the 411 density maps that we collected in this manner, weretrieve 16,070 training examples. To generate the secondary structure masks, we filter out allatoms for each structural element and set all voxels within a distance oftwo around each filtered atom to one. In total this gives us 25 different masksfor each training example (C\u03b1 mask, backbone mask, three secondarystructure masks, and 20 amino acid type masks).As mentioned above, the determining factor for the position of an aminoacid is the position of its C\u03b1 atom. We can now mask all other confidencemaps with each chain area that we identified in order to continue theprediction independently for all chains. Backbone prediction of EMD-0478 density map (human TPC2 channel) (humanTPC2 channel) with identified chains marked in different colors. The values 2.11 and 1.149 are constants that definethe radius and pitch of the helix to best match those of an \u03b1-helix. \u00d7 ) \u2212  +  (2)=Equation 2 however, cannot be used to describe an \u03b1-helix which doesnot center around the z-axis or whose shape is not a straight cylinder. However,instead of using the Euclidean distances between atoms to measure thetotal length of the path, we use a custom confidence score that expresseshow confident we are that two atoms share a connection. \u00d78(,,,,,..)> , , < , otherwiseIn order to apply the TSP algorithm, we also need to specify a start/endpoint. However, we do not know yet at which atom the chain will start andend. Therefore, we add a new atom that is connected to every other atomwith a confidence of 1. An example of the application ofthe TSP on a list of C\u03b1 atoms can be seen in Fig 6.Fig 6. \u03b1-Helix extracted from the backbone prediction of the EMD-8515 density mapin tan color and its screw axis in teal color. \u03b1-Helix extracted from the prediction of the EMD-8515 density map. ( Additionally, we willcompare its performance against Phenix, as well as the C-CNN backboneprediction method. Thisgives us an idea how close the predicted atoms are to their correct counterparts. However,all predicted amino acids are still connected as a single chain. The predictedsecondary structure elements in the Phenix prediction, particularly for sheets,appear also much less accurate than the ones made by the DeepTracer. As mentioned in the introduction, a central goal of the DeepTracer was toimprove the runtime of protein structure predictions. This makes itpossible to predict ever larger density maps which allows for a more versatileapplication of the method. The original density map next to the predictionof the DeepTracer can be seen in Fig 11.Fig 11. When looking at the results reported in Table 1, we can note a coupleof things. If wecompare the DeepTracer to Phenix based on these two metrics, we can seethat the coverage improvements significantly outweigh the smalldeterioration in RMSD. However, the bigger implications lay in theprediction of larger proteins. This gives promise to the incorporation ofamino acid sequence into the prediction pipeline."}