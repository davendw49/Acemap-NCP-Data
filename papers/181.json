{"date": "2020/02/29", "journal": "medrxiv", "authors": "Peter X Song, Lili Wang, Yiwang Zhou, Jie He, Bin Zhu, Fei Wang, Lu Tang, Marisa Eisenberg", "title": "An epidemiological forecast model and software assessing interventions on COVID-19 epidemic in China", "type": "preprint article", "abstract": "We develop a health informatics toolbox that enables public health workers to timely analyze and evaluate the time-course dynamics of the novel coronavirus (COVID-19) infection using the public available data from the China CDC. This toolbox is built upon a hierarchical epidemiological model in which two observed time series of daily proportions of infected and removed cases are emitted from the underlying infection dynamics governed by a Markov SIR infectious disease process. We extend the SIR model to incorporate various types of time-varying quarantine protocols, including government-level macro isolation policies and community-level micro inspection measures. We develop a calibration procedure for under-reported infected cases. This toolbox provides forecast, in both online and o ine forms, of turning points of interest, including the time when daily infected proportion becomes smaller than the previous ones and the time when daily infected proportions becomes smaller than that of daily removed proportion, as well as the ending time of the epidemic. An R software is made available for the public, and examples on the use of this software are illustrated. Some possible extensions of our novel epidemiological models are discussed.", "text": "        The outbreak of the coronavirus disease or COVID-19, originated in Wuhan, the capital city ofHubei province, spreads out quickly in Hubei and then in China, South Korea, Japan, Iran andItaly, as well as many other cities across the world. Being one of the great epidemics in the 21stcentury, till February 25, 2020, in China it has caused a total of 78,195 con rmed infections, 2,718deaths and 30,078 recovered cases, and 2,491 suspected cases still remained to be tested. Since theoutbreak of the epidemic, many clinical papers [                In addition to vaccination, quarantine or medical isolation is the human wisdom that has beenproved to be one of the most e ective ways to stop the spreading of infectious diseases such asSARS [35, 29, 22] and plague [                The question of the most importance, which draws most attention, concerns when the spreadof COVID-19 will end. This question has to be answered by a prediction model using the dailymost-updated data from the China CDC. Unfortunately, it is extremely di cult to make right andprecise prediction due to the limited amount of available data, which are thought to be inaccuratedue to the issue of under-reporting. Many prediction models [        All the above points illustrate the complexity of human interventions on the spread ofCOVID19, including but not limited to in-home quarantine, hospitalization, community enforcement ofwearing masks, minimizing outdoor activities, and changed diagnostic criteria by the government.The prediction model must take such features into account in order to provide meaningful analysesand hopefully reasonable predictions. However, most existing prediction models do not have thecapacity to incorporate changing interventions in reality, and with no such critical component oftime-varying intervention in the model, predicted turning points would be untrustworthy. Our newmodel and analytic toolbox aim to ll in this signi cant gap.        We develop a health informatics toolbox, with an R package eSIR [        AIM 2 : Incorporate time-varying quarantine protocols in the model of COVID-19 infection dynamicsvia an extension of the classical epidemiological SIR model. This dynamic infection systemnecessitates the forecast of the future trend of COVID-19 spread.AIM 3 : Provide an R software package to health workers who can conveniently perform their ownanalyses using their substantive knowledge and perhaps better quality data from provincesin China or from other countries.By no means the toolbox developed by us would give an accurate prediction of turning points, butrather we hope to provide a data analytic toolbox to people who may have better domain-speci cknowledge and experience as well as high quality data to carry out independent predictions.          Our informatics toolbox is built upon a state-space model [          The R package eSIR is available at https://github.com/lilywang1988/eSIR. This paper isorganized as follows. Section 2 presents our new epidemiological forecast model incorporatingtimevarying quarantine protocols. Section 3 concerns the algorithmic implementation via Markov ChainMonte Carlo and a deliverable R software. Section 4 is devoted to the analysis of COVID-19 datawithin and outside Hubei, where a calibration of under-reporting is proposed. Section 5 gives someconcluding remarks, and some technical details are included in the appendices.22.1We begin with a basic epidemiological model in the framework of state-space SIR models withno consideration of quarantine protocols. This framework was proposed by [23] with onlyonedimensional time series of infected proportions. Refer to Chapter 9-12 of [30] for an introduction tostate-space models. Here we consider two time series of proportions of infected and removed cases,denoted by YtI and YtR at time t, respectively, where the compartment of removed R is a sum ofthe proportions of recovered cases and deaths at time t. We assume that the 2-dimensional timeseries of pYtI ; YtRqJ follows a state-space model with the beta distributions at time t:YtI | t;YtR| t;Betap I tI ; I p1Betap R tI ; Rp1tI qq;tI qq;where tI and tR are the respective prevalence of infection and removal at time t, and I andare the parameters controlling the respective variances of the observed proportions.As shown in Figure 1, these observed time series are emitted from the underlying latentdynamics of COVID-19 infection characterized by the latent Markov process t. It is easy to see that theexpected proportions in both models (1) and (2) are equal to the prevalence of infection and theprobability of removal at time t, namely EpYtI | tq tI and EpYtR| tq tR. See Appendix B.Moreover, the latent population prevalence t p tS; tI ; tRqJ is a three-dimensional Markov process, inwhich tS is the probability of a person being susceptible or at risk at time t, tI is the probabilityof a person being infected at time t, and tR is the probability of a person being removed from theinfectious system (either recovered or dead) at time t. Obviously, tS tI tR 1. We assumethat this 3-dimensional prevalence process t is governed by the following Markov model:t| t 1;Dirichletp f p t 1; ; qq;(3)where parameter scales the variance of the Dirichlet distribution and function f p q is a3dimensional vector that determines the mean of the Dirichlet distribution. The function f isthe engine of the infection dynamics, which operates according to the classical infectious diseaseddttS tS tI ; ddttI tS tI tI ; and ddttR tI : (4)Note that the explicit solution to the above system (4) of ordinary di erential equations isunavailable. Following [23], we invoke the fourth-order Runge{Kutta(RK4) approximation, resulting inan approximate of f p t 1; ; q as follows:kS4            t 1sktI4 1skR4t 1s;where all these kt terms are given in the appendix A. Denote the set of model parameters byp ; ; 0; ; qJ, which will be estimated using the MCMC method [            The basic epidemiological model with both constant transmission and removal rates in SIR model(4) does not re ect the reality in China, where all levels of quarantines have been enforced. Manyforms of human interventions that are altering the transmission rate over time include (i)individuallevel protective measures such as wearing masks and safety glasses, using hygiene, and takinginhome isolation, and (ii) community-level quarantines such as hospitalization for infected cases, cityblockade, tra c control and restricted social activities, and so on. In addition, the virus itself maymutate to evolve, so to increase the potential rate of false negative in the disease diagnosis. Asa result, some individual virus carriers are not contained. Thus, the transmission rate indeedvaries over time, which should be accounted in the modeling.One extension to the above basic epidemiological model is to allow a time-varying probabilitythat a susceptible person meets an infected person or vice versa. Suppose at a time t, qSptq P r0; 1sI tis the chance of an at-risk person being in-home isolation, and q p q P r0; 1s is the chance of aninfected person being in-hospital quarantine. Thus, the chance of disease transmission when anat-risk person meets an infected person is modi ed as:t1qSptqu tSt1qI ptqu tI :ptq tS tI ;with ptq : t1 qSptqut1 qI ptqu P r0; 1s. In e ect, this ptq modi es the chance of a susceptibleperson meeting with an infected person or vice versa, which is termed as a transmission modi erdue to quarantine in this paper. Obviously, with no quarantine in place, ptq 1 for all time. SeeFigure 2. This results in a new SIR model with a time-varying transmission rate modi er:ptq''%ddttS ptq tS tI ; ddttI ptq tS tI tI ; and ddttR tI ; (5)where the product term ptq de nes a realistic transmission rate re ective to the currently enforcedquarantine measures of all levels in China. Note that the above extended SIR model assumesprimarily that both population-level chance of being susceptible and population-level chance ofbeing infected remain the same, but the chance of a susceptible person meeting with an infectedperson is reduced by ptq.The transmission rate modi er ptq needs to be speci ed according to actual quarantineprotocols in a given region. A possible choice of ptq may be a step function that re ectsgovernmentinitiated macro isolation measures in Wuhan, Hubei province:$''&01; if t \u00a4 Jan 23; no concrete quarantine protocols;02; if t P pJan 23; Feb 4s; city blockade;03; if t P pFeb 4; Feb 8s; enhanced quarantine;04; if t \u00a1 Feb 8; opening of new hospitals.When 0 p 01; 02; 03; 04q are chosen with di erent values, as shown in Figure 3, we obtaindi erent types of transmission rate modi ers aligned with di erent quarantine protocols.Alternatively, the modi er ptq may be speci ed as a continuous function that re ects steadilyincreased community-level awareness and responsibility of voluntary quarantine and preventivemeasures, which may be regarded as a kind of micro isolation measure initiated by individuals orlocal self-organized inspections. For example, as shown in Figure 4, we may choose the followingexponential functions:ptqexpp0tq or ptqexpt p 0tq u; 0 \u00a1 0;\u00a1 0:Technically, the RK's approximate of f function in Appendix A may be easily obtained byreplacing by ptq in the speci cation of the latent prevalence model (3), and moreover in allquantities and steps in the MCMC implementation. See the detailed in Section 3.2.3An alternative way to incorporate quarantine measures into the basic epidemiological model (4) isto add a new quarantine compartment that collects quarantined individuals who would have nochance of meeting any infected individuals in the infection system, as shown in Figure 5. This modelallows to characterize time-varying proportions of susceptible cases due largely to thegovernmentenforced stringent in-home isolation outside of Hubei province. The basic SIR model in equation(4) is then extended by adding a quarantine compartment with a time-varying rate of quarantineptq, which is the chance of a susceptible person being willing to take in-home isolation at time t.The extended SIR takes the following 4-dimensional latent process p tS; tQ; tI ; tRqJ:d tQdtd tIdtptq tS;S It td tSdttI ;S It tptq tS;d tRdttI ;(6)where tSQtItRt1.We suppose that the quarantine rate ptq is a Dirac delta function with jumps at times whenmajor macro quarantine measures are enforced. For example, we may specify the ptq function asfollows:ptq$''&01; if t Jan 23; city blockade;02; if t Feb 4; enhanced quarantine;' 03; if t Feb 8; opening of new hospitals;'% 0; otherwise.Here we show several examples of multi-point instantaneous quarantine rates in Figure 6 with jumpsizes equal to 0 p 01; 02; 03q that occur respectively at dates of (Jan 23, Feb 4, Feb 8). Inparticular, we plot three scenarios, e.g., no intervention ( 0 p0; 0; 0q), multiple moderate jumps( 0 p0:1; 0:4; 0:3q), and only one large jump ( 0 p0; 0:9; 0q). Note that at each jump, therespective proportion of the susceptible population would move to the quarantine compartment.For example, with 0 p0:1; 0:4; 0:3q, the quarantine compartment will be enlarged accumulativelyover three time points as 0:1 tS1 0:4 tS2 0:3 tS3 .The f p t 1; ; q function determined by the above extended SIR model (6) can be solvedby applying the fourth-order Runge-Kutta approximation, and the resulting solution is given inAppendix A. To deal with the Dirac delta function ptq, we develop a two-step approximation formodel (6). In brief, we rst solve a continuous function without change points via the di erentialequations in (5), and then we directly move ptq tS of the susceptible compartment to the quarantinecompartment. From our experience, this approach largely improves the approximation accuracy inthe presence of discontinuities.33.1We implemented the MCMC algorithm to collect draws from the posterior distributions, and furtherobtain posterior estimates and credible intervals of the unknown parameters in the above modelsspeci ed in Section 2. Because of the hierarchical structure in the state-space model consideredin this paper, the posterior distributions can be obtained straightforwardly. The R package rjags[25] can be directly applied to draw samples from the posterior distributions, so we omit thetechnical details. The latent Markov t processes are sampled and forecasted by the MCMCsampler, particularly for the prevalence of infection and the probability of removal, tI and tR,which enables us to determine turning points of interest and the reproduction number R0.The rst turning point of interest is the time when the daily number of new infected cases stopsincreasing. Mathematically, this corresponds to the time t at which :tI 0 or the gradient of 9tIis zero. As illustrated by Panel A in Figure 7, the peak of 9tI , denoted by the vertical green line,is the rst turning point of interest. The second turning point is the time when the cumulativeinfected cases reaches its maximum, meaning 9tI 0. In principle, the second turning point occursonly after the rst one, as shown in Panel B in Figure 7.The reproduction number R0 of an infectious disease is estimated by the ratio R0 { , whereand are both estimated from their posterior distributions. Because our models consider thequarantine compartment, R0 might change according to the forms of quarantine protocols. Weadopt a standard MCMC algorithm to draw the latent process. Let t0 be the current time up towhich we have observed data pY0I:t0 ; Y0R:t0 q. To perform M draws of YtI ; YtR for t P rt0 1; T s, weproceed as follows: for each mpmq from the posterior r t| tpm1q; pmqs of the prevalence process, at tt(2) draw pYtIpmq; YtRpmqq from rYtI | tpmq; pmqs and rYtR| tpmq; pmqs according to the observedprocess, at t t0 1; : : : ; T , respectively;The prior distributions are speci ed with some of the hyper-parameters being set according to theI0R0Gammap2; 0:0001q;Betap1; pY1I q 1q; 0S Betap1; pY1Rq 1q; 0R 1LogNp1:099; 0:096q with EpR0q 3:15; SDpR0qLogNp 2:955; 0:910q with Ep q 0:0117; SDp qI RGammap2; 0:0001q;S01;0:1;0I ;R0 ;Gammap2; 0:0001q:In the default setting the variances of the above prior distributions are set at relatively largevalues to re ect the fact that limited prior knowledge of these epidemiological model parameters isavailable. When more information becomes accessible during the course of the epidemic, smallerprior variance values may be used, leading to tighter credible intervals for the model parametersand turning points.3.2We deliver an R software package that is able to output the MCMC estimation, inference andprediction under the epidemiological model with two proposed extended SIR models that incorporatetime-varying quarantine protocols. These new models have been discussed in detail in Sections2.2 and 2.3. Our R package, named eSIR, uses daily-updated time series of infected and removedproportions as input data. The R package is available at GitHub lilywang1988/eSIR, and itsuser manual is appended as the supplementary material of this paper. The quarantine functionsare prede ned and will be treated as known functions of protocols/policies in the estimation andprediction steps. We let the transmission rate modi er ptq be either a step function or anexponential function, and let the quarantine rate ptq follow a Dirac delta function with pre-speci edpoints of jump and sizes of jumps. The package provides various plots for users to visualize theMCMC results, including the estimated prevalence of infection and the estimated probability ofremoval, and predicted turning points of interest. Various summary statistics are listed in theoutput, including posterior mean estimates of the transmission and removal rates, estimate of thereproduction number, and forecasts of turning points and their 95% credible intervals. Moreover,the package gives multiple options to users who can save the entire MCMC results, including theoutput tables and summary plots, traceplots for MCMC quality control, and full MCMC drawsfor user's own summary analyses. Some illustrations on the use of this software package is givenin Section 4. In addition, we developed an online R Shiny App that can automatically update theresults whenever the China CDC updates the daily COVID-19 data.44.1Under-reporting of infections is a common issue in the data collection of infectious disease, especiallyat the beginning of an outbreak. When medical diagnostic tools become more accurate and reliable,as well the transparency of preventive measures gets improved for an exchange of voluntary in-homequarantine, certain adjustments in data typically occur. It is shown in Figure 8 that on Feb 12 thecumulative and daily added number of infected cases in Hubei had clear jumps with signi cantlylarge sizes. Such sizable jumps cannot happen within one day, rather they represent an accumulationof cases that have not been reported in previous dates prior to Feb 12. To x this under-reportingissue, we develop a calibration procedure with the detail in Appendix C. Below we brie y describeour approach for the calibration of the infected cases.We assume an exponential growth curve for the cumulative number of infected cases in Hubeibefore Feb 12 of the form yptq ae t b, where parameters ; a; b are to be estimated. Underthe boundary conditions ypt Jan 12q 0 and ypt Feb 12q a expp31 q b, we would like tominimize the one-step ahead extrapolation error on Feb 13. The constrained optimal solution canbe obtained by the means of Lagrange Multipliers; the estimates are ^ 0:06605; a^ 7142:80; ^b7142:80. The resulting calibration curves for the cumulative and daily added number of infectedcases are shown as the solid red curves in Figure 8. For example, on Jan 31, the reported cumulativenumber of infected cases is 7,153, but the calibrated number of infected cases is 17,911, with anincrement of 10,758 cases. As shown later, this data quality control (QC) step helps improve theperformance of MCMC.4.2          We applied our proposed models, algorithms and R package eSIR to analyze the COVID-19 datacollected from the public website DXY.cn. The earliest public records for the provincial data areavailable since Jan 20, 2020. According to an existing R package on GitHub GuangchuangYu/nCov2019[          First, we show the analysis of the Hubei COVID-19 data. Note that option dic=T enables tocalculate the deviance information criterion (DIC) for model selection, while options, save_files=Tand save_mcmc, allow the storage of MCMC output tables, plots, summary statistics and even fullMCMC draws, which may be saved via the path of file_add, or otherwise via the current workingdirectory. The major results returned from the package include predicted cumulative proportions,predicted turning points of interest, two ggplot2 [36] objects of the summary plots related toboth infection and removed compartments, a summary output table containing all the posteriormeans, median and credible intervals of the model parameters, and DIC if opted. Thetraceplots and other useful diagnostic plots are also provided and automatically saved if save_files=Tis opted. In the package, function tvt.eSIR() works on the epidemiological model withtimevarying transmission rate in Section 2.2, and qh.eSIR() for the other epidemiological model witha quarantine compartment in Section 2.3. Note that in function tvt.eSIR(), with a choice ofexponential=F, a step function is run in the MCMC when both change_time and pi0 are speci ed.To t the model with a continuous transmission rate modi er function, user may set exponential=Tand specify a value of lambda0. The default is to run the basic epidemiological model with noquarantine or ptq 1 in Section 2.1. death_in_R is usually set to be the average ratio of deathand removed proportions at each observation time point, which is used to estimate the death curvein the forecast plot of the removed compartment. Below are the R scripts used in the analysis.### Example 1: Step function pi(t)### Y and R are observed proportions of infected and removed compartmentschange_time <- c(\"01/23/2020\",\"02/04/2020\",\"02/08/2020\")pi0<- c(1.0,0.9,0.5,0.1)res.step <-tvt.eSIR(Y,R,begin_str=\"01/13/2020\",death_in_R = 0.4,T_fin=200,pi0=pi0,change_time=change_time,dic=T,casename=\"Hubei_step\",save_files = T,save_mcmc=F,M=5e2,nburnin = 2e2)res.step$plot_infectionres.step$plot_removedres.step$dic_val### Example 2: continuous exponential function pi(t)res.exp <- tvt.eSIR(Y,R,begin_str=\"01/13/2020\",death_in_R = 0.4,T_fin=200,exponential=TRUE,dic=F,lambda0=0.05,casename=\"Hubei_exp\",save_files = F,save_mcmc=F,M=5e2,nburnin = 2e2)res.exp$plot_infection#res.exp$plot_removed### Example 3: the basic state-space SIR model, pi(t)=1res.nopi <- tvt.eSIR(Y,R,begin_str=\"01/13/2020\",death_in_R = 0.4,T_fin=200,casename=\"Hubei_nopi\",save_files = F,M=5e2,nburnin = 2e2)res.nopi$plot_infection#res.nopi$plot_removedIn the above R coding scripts, only very short MCMC chains are speci ed for the considerationof running time. In practice, it is recommended to set M=5e5 and nburnin=2e5 to achieve desirableburn-ins and yield stable MCMC draws. We tried the step function given by Panel C in Figure 3with pi0=c(1,0.9,0.5,0.1), an exponential function given by Panel B in Figure 4 with ratelambda0=0.05, both of which were compared with the basic model with ptq 1. The results ofthe three modi er functions obtained from the tvt.eSIR function are summarized in Figures 9-11.In these forecasting plots of the infected and removed compartments (Panel A and Panel C), theblack dots left to the blue vertical line denote the observed proportions of the infected and removedcompartments on the last date of available observations or before. That is, the blue verticalmarks time t0 as de ned in Section 3. The green and purple vertical lines denote the rst andsecond turning points, respectively. The salmon color area denotes the 95% credible interval of thepredicted proportions YtI and YtR after t0, respectively, while the cyan color area represents eitherthe 95% credible intervals of the prevalence ( tI ) and or that of the probability of removal ( tR) priorto time t0. The gray and red curves are the posterior mean and median curves. The black curve inthe plot (Panel C) is the proportion of deaths estimated from a pre-speci ed ratio death_in_R. Themiddle Panel B displays important dynamic features of the infection via a spaghetti plot, in which 20randomly selected MCMC draws of the rst-order derivative of the posterior prevalence of infection,namely 9tI . The black curve is the posterior mean of the derivative, and the vertical lines mark timesof turning points corresponding respectively to those shown in Panel A and Panel C. Moreover, the95% credible intervals of these turning points are also highlighted by semi-transparent rectangles inPanel B. As shown in these gures, the transmission rate modi er ptq played an important roles inshortening the key turning points of the epidemic, and its e ect on both estimation and predictionof the COVID-19 infection dynamics has been clearly demonstrated .Next, we analyzed the data from the rest of the Chinese population (i.e. the provinces outsideHubei) starting on Jan 23. We set begin_str=\"01/23/2020\"in tvt.eSIR. To address the delayedstarting time, we included two change points for the step function ptq at [Feb 4, Feb 8] with0 p0:8; 0:1q. The exponential function remained the same. It is noted that the spread ofwithout intervention, ptqwith an exponential transmission rate modi er ptqCOVID-19 outside Hubei has been so far much less severe. Possible reasons for such low proportionsof infection and deaths include (i) discontinuing the tra c connections between Hubei and theprovinces, (ii) more timely caution and preventative measures taken, and (iii) a comparativelylarge population that dilutes the exposed group. When Panel A in Figure 12 is zoomed in, some ofthe observed proportions (black dots) are deviated from the posterior mean or median of the ttedprevalence albeit they all fall in the 95% credible intervals, as shown by Panel A in Figures 13 and14. Since the latent process follows the SIR di erential equations, there may be a lack of t forthe SIR model to accommodate a very large and complex population of 1.3 billion people, in whichmost of the subjects are not at risk. The proposed models should work much better for individualprovinces, but we did not perform such analyses.The other epidemiological model with an added quarantine compartment as an absorbing statewas tted via our R function qh.eSIR in the package eSIR. The arguments used in qh.eSIR() arealmost identical to those in tvt.eSIR(). Note that if the quarantine rate function is set at constant0, this model will be reduced to a basic epidemiological SIR model.### Example 4: Dirac delta function of the quarantine processchange_time <- c(\"01/23/2020\",\"02/04/2020\",\"02/08/2020\")phi <- c(0.1,0.4,0.4)res.q <- qh.eSIR (Y,R,begin_str=\"01/13/2020\",death_in_R = 0.4,phi0=phi0,change_time=change_time,casename=\"Hubei_q\",save_files = T,save_mcmc = F,M=5e2,nburnin = 2e2)res.q$plot_infectionother provinces outside Hubei withptqprovinces outside Hubei with with an exponential transmission rate modi erptq#res.q$plot_removed### Example 5: basic state-space SIR modelres.noq <- qh.eSIR (Y,R,begin_str=\"01/13/2020\",death_in_R = 0.4,T_fin=200,casename=\"Hubei_noq\",M=5e2,nburnin = 2e2)res.noq$plot_infectionWe applied the R function qh.eSIR in analyses of the data within and outside Hubei. Results aresummarized in Figures 15-16. Our analyses once again clearly indicated that stringent quarantineprotocols can largely reduce the spread of COVID-19 both within Hubei and outside Hubei. Yet, itis known that too strict quarantine can cause back re; people may lose their trust and patience intheir committed system, and consequently may try to reduce compliance or even avoid quarantine.We also present the posterior mean probability of staying quarantine compartment in Figure 17within Hubei and outside Hubei. Note that Jan 23 was not set as a change point for the caseof outside Hubei, leading only to two jumps. It is evident that by Feb 8, more than 90% of theChinese population have taken in-home isolation or as such, re ective to a very strict quarantineprotocol enforced in the entire country.As described in Subsection 4.1, we corrected the under-reported proportion of infections in Hubeiprovince prior to Feb 12, when a big jump occurred on one day. We repeated the same analysesusing the calibrated data of infections, and the corresponding results are shown in Figures 18-21.It is interesting to see that the abrupt rise in the infection proportion on Feb 12 disappeared in allPanel A in these new analyses, and the observed data (i.e. the black dots) align better with thewith time-varying quarantine speci ed by0r0:1; 0:9; 0; 5s at change points [Jan 23, Feb 4, Feb[Feb 4, Feb 8].provinces outside Hubei with time-varying quarantine speci ed by0r0:9; 0; 5s at change pointsMean3.006.305.616.00Mean2.583.363.023.5895%CI[1.52, 4.26][1.96, 5.26][1.74, 4.89][1.85, 6.10]credible intervals of all the latent processes. We also notice that after the correction, the estimatedreproduction numbers R0 became smaller. The reproduction numbers estimated from di erentmodels for within and outside Hubei, with and without the data calibration, together with their95% credible intervals are summarized in Table 1.            It is worth pointing out that the estimates of the reproduction numbers obtained from theepidemiological models with time-varying transmission or quarantine rates appear larger than thoseobtained from the basic model with no quarantine. This is no surprising as our new models explicitlyincorporate interventions, so that the estimated R0 is an adjusted number with the in uence ofinterventions be removed. In contrast, the basic model with no use of the quarantine modi erimplicitly integrates the e ect of interventions into the transmission rate , and consequently theestimated R0 is reduced due to the contribution from interventions. Our analyses suggest thatreproduction numbers R0 of COVID-19 without public health interventions would be around 4-5within Hubei and around 3-3.5 outside Hubei with relatively big credible intervals. These ndingsare in agreement with ndings from [            We develop an epidemiological forecast model with an R software package to assess e ects ofinterventions on the COVID-19 epidemic within Hubei and outside Hubei in China. Since ourwith an exponential transmission rate modi erptqexpp 0:05tq after data calibration.[22] World Health Organization et al. Summary of probable sars cases with onset ofillness from 1 november 2002 to 31 july 2003. http://www. who.int/csr/sars/country/table2004 04 21/en/index. html, 2003.[23] Dave Osthus, Kyle S Hickmann, Petruta C Caragea, Dave Higdon, and Sara Y Del Valle.Forecasting seasonal in uenza with a state-space sir model. The annals of applied statistics,11(1):202, 2017.[24] Liangrong Peng, Wuyue Yang, Dongyan Zhang, Changjing Zhuge, and Liu Hong. Epidemicanalysis of covid-19 in china by dynamical modeling. arXiv preprint arXiv:2002.06563, 2020.[25] Martyn Plummer. rjags: Bayesian Graphical Models using MCMC, 2019. R package version4-10.[26] R Core Team. R: A Language and Environment for Statistical Computing. R Foundation for[29] Richard D Smith. Responding to global infectious disease outbreaks: lessons from sars onthe role of risk perception, communication and management. Social science & medicine,63(12):3113{3123, 2006.[30] Peter X-K. Song. Correlated Data Analysis: Modeling, Analytics, and Applications. Springer,2007.[31] Peter Xue-Kun Song. Monte carlo kalman lter and smoothing for multivariate discrete statespace models. Canadian Journal of Statistics, 28(3):641{652, 2000.[32] Lorenzo Subissi, Clara C Posthuma, Axelle Collet, Jessika C Zevenhoven-Dobbe, Alexander Eacute respiratory syndrome coronavirus protein complex integrates processive rna polymeraseand exonuclease activities. Proceedings of the National Academy of Sciences, 111(37):E3900{E3909, 2014.[33] Haoxuan Sun, Yumou Qiu, Han Yan, Yaxuan Huang, Yuru Zhu, and Song Xi Chen. Trackingand predicting covid-19 epidemic in china mainland. medRxiv, 2020.[34] Chen Wang, Peter W Horby, Frederick G Hayden, and George F Gao. A novel coronavirusoutbreak of global health concern. The Lancet, 2020.[35] WHO. Emergencies preparedness, response. pneumonia of unknown origin { china. diseaseoutbreak news. Available online: https:// HYPERLINK\"http://www.who.int/csr/don/12january-2020-novel-coronavirus-china/en/\" www.who.int/csr/don/12-january-2020-novelcoronavirus-china/en/ accessed on 05 February 2020, 2020.[36] Hadley Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York,2016.[37] Yu-Tao Xiang, Wen Li, Qinge Zhang, Yu Jin, Wen-Wang Rao, Liang-Nan Zeng, Grace KIin china. The Lancet, 2020.[38] Xiao-Wei Xu, Xiao-Xin Wu, Xian-Gao Jiang, Kai-Jin Xu, Ling-Jun Ying, Chun-Lian Ma,ShiBo Li, Hua-Ying Wang, Sheng Zhang, Hai-Nv Gao, et al. Clinical ndings in a group of patientsinfected with the 2019 novel coronavirus (sars-cov-2) outside of wuhan, china: retrospectivecase series. BMJ, 368, 2020.[41] Bin Zhu, Jeremy MG Taylor, and Peter X-K Song. Signal extraction and breakpointidentication for array cgh data using robust state space model. arXiv preprint arXiv:1201.5169,2012.The forth order Runge-Kutta(RK4) method gives an approximate of f p t 1; ; q in equation (4)as follows:whereandkI1tkI2tkI3tkI4tktS1ktS2ktS3ktS4S It tSr tSr tSr ttS tI ;Sr tSr tSr ttI ;0:5ktS1 sr tI0:5ktS2 sr tIkS3 It sr tktR1ktR2ktR3ktR40:5ktS1 sr tI0:5ktS2 sr tIkS3 It sr t0:5ktI1 s;0:5ktI2 s;ktI3 s;0:5ktI1 s0:5ktI2 sktI3 sIr tIr tIr tktI3 s;0:5ktI1 s;0:5ktI2 s;tI ;Ir tIr tIr t0:5ktI1 s;0:5ktI2 s;ktI3 s:A.2Using the RK4 approximation, f p t 1; ; q in the extended SIR model (6) with a quarantinecompartment can be approximated following the two iterative steps:1. Solve the f p t 1; ; q in Appendix A without considering the quarantine with f p qLet t 1 r 1pt 1q; 2pt 1q; 3pt 1qsT, and it is easy to show that the sum \u00b03k 1 kpt 1q 1 tQ.Thus we can regenerate the next day's t following a Dirichlet distribution adjusted by theprevalence of the quarantine compartment t Dirichletp t 1{p1 tQqq. The estimated prevalencevalues become t p1 tQq t . We follow above two steps and nish the complete prevalenceprocesses. Note that the deduction of susceptible compartments might cause tS \u00a4 0, we will boundsuch prevalence value to be consistently 0, which is equivalent to terminating transmission amongsusceptible subjects.BFor the sake of being self-contained, we list the moments of both Beta and Dirichlet distributions.The mean and variance of Beta distribution Betap ; q are respectively:While to Dirchlet distribution Dirpq, we havewherep 1; 2; 3; 4qT with 1234CMean; Var111p11q1 21 31 4p2p1q2p2q1 22 32 4:1q1 32 33 43p13q1 42 43 44p14q;As is mentioned in the Introduction, the issue of under-reporting may cause bias in prediction. Inorder to adjust the under-reported number of infected cases, we apply the following algorithm tocalibrate the number of infections before Feb 12, during which time the Chinese government onlyrelies on the RNA test for diagnosis, which was realized later with low sensitivity leading to manyfalse negatives.We assume that the cumulative number of infected cases between Jan 13 and Feb 12 when asudden big jump occurs follows an exponential function,yptqae tb;where t P t1; 2; : : : u and a; b; are parameters to be estimated. Here, t 1 stands for Jan 13 andt 31 stands for Feb 12. Under the condition of yp0q 0, we can easily get thatyptqae ta:To estimate parameter and a, we want to minimize the least square error of the estimated numbery^ptq of infected cases at t 32 (Feb 13), which is one day after the Chinese government changed thediagnosis protocol. It is assumed that the di erence between the predicted and observed numberof infections on Feb 13 would not be big if the model were established well, although the long termdi erence might be large due to other interventions. Therefore, the optimization problem we wantto solve is,mina;typ32qs.t. ae31ae32au2ayp31q:The constraint ae31 a yp31q is used to ensure that the cumulative number of infected casestill Feb 12 equals to the observed value yp31q. The optimization problem can be solved using themethod of Lagrange Multipliers. Obtained ^ 0:06605; a^ 7142:80. The calibrated number ofinfected cased between Jan 13 and Feb 12 is shown in Figure 8. The proposed calibration methodcorrected the under-reporting issue, at least partially.Package \u2018eSIR\u2019February 29, 2020Type PackageTitle Extended state-space SIR modelsVersion 0.2.0Date 2020-02-19Author Song Lab (http://www.umich.edu/~songlab/)Maintainer Lili Wang <lilywang@umich.edu>Description An inplementation of extendedstatespace SIR models developed by Song Lab at UM school of Public HealthLicense CC BY 4.0Encoding UTF-8RoxygenNote 6.1.1Depends rjags, scales, ggplot2, chron, gtools, data.tableR topics documented:qh.eSIR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .tvt.eSIR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .IndexExtended state-space SIR with quarantineFit an extended state-space SIR model being reduced by in-home hospitalization.qh.eSIR(Y, R, phi0 = NULL, change_time = NULL,begin_str = \"01/13/2020\", T_fin = 200, nchain = 4,nadapt = 10000, M = 500, thn = 10, nburnin = 200, dic = FALSE,death_in_R = 0.02, casename = \"qh.eSIR\", beta0 = 0.2586,gamma0 = 0.0821, R0 = beta0/gamma0, gamma0_sd = 0.1, R0_sd = 1,file_add = character(0), save_files = FALSE, save_mcmc = FALSE,save_plot_data = FALSE)148        YRphi0change_timebegin_strT_finnchainnadaptMthnnburnindicdeath_in_Rthe time series of daily observed infected compartment proportions.the time series of daily observed removed compartment proportions, includingdeath and recovered.a vector of values of the dirac delta function t. Each entry denotes theproportion that will be qurantined at each change time point. Note that all the entrieslie between 0 and 1, its default is NULL.the change points over time corresponding to phi0, to formulate the dirac deltafunction t; its defalt value is NULL.the character of starting time, the default is \"01/13/2020\".the end of follow-up time after the beginning date begin_str, the default is 200.the number of MCMC chains generated by rjags, the default is 4.the iteration number of adaptation in the MCMC. We recommend using at leastthe default value 1e4 to obtained fully adapted chains.the number of draws in each chain, with no thinning. The default is M=5e2 butsuggest using 5e5.the thinning interval between mixing. The total number of draws thus wouldbecome round(M/thn)*nchain. The default is 10.the burn-in period. The default is 2e2 but suggest 2e5.logical, whether compute the DIC (deviance information criterion) for modelselection.the numeric value of average of cumulative deaths in the removedcompartments. The default is 0.4 within Hubei and 0.02 outside Hubei.the string of the job\u2019s name. The default is \"qh.eSIR\".the hyperparameter of average transmission rate, the default is the one estimatedfrom the SARS first-month outbreak (0.2586).the hyperparameter of average removed rate, the default is the one estimatedfrom the SARS first-month outbreak (0.0821).the hyperparameter of the mean reproduction number R0. The default is thusthe ratio of beta0/gamma0, which can be specified directly.the standard deviation for the prior distrbution of the removed rate , the defaultis 0.1.the standard deviation for the prior disbution of R0, the default is 1.the string to denote the location of saving output files and tables.logical, whether save (TRUE) all the MCMC outputs or not (FALSE).Theoutput file will be an .RData file named by the casename. We include arraysof prevalence values of the three compartments with their matrices ofposterior draws up to the last date of the collected data as theta_p[        save_plot_data logical, whether save the plotting data or not.In this function we allow it to characterize time-varying proportions of susceptible due togovernmentenforced stringent in-home isolation. We expanded the SIR model by adding a quarantinecompartment with a time-varying rate of quarantine t, the chance of a susceptible person being willing totake in-home isolation at time t.casenamethe predefined casename.incidence_mean mean incidence.summary tables including the posterior mean of the prevalance processes of the3 states compartments ( tS ; tI ; tR; tH ) at last date of data collected ((t0) decidedby the lengths of your input data Y and R), and their respective credible inctervals(ci); the respective means and ci\u2019s of the reporduction number (R0), removedrate ( ), transmission rate ( ).plot_infection plot of summarizing and forecasting for the infection compartment, in whichthe vertial blue line denotes the last date of data collected (t0), the vertialdarkgray line denotes the deacceleration point (first turning point) that the posteriormean first-derivative of infection prevalence _tI achieves the maximum, thevertical purple line denotes the second turning point that the posterior meanfirstderivative infection proportion _tI equals zero, the darkgray line denotes theposterior mean of the infection prevalence tI and the red line denotes its posteriormedian.plot of summarizing and forecasting for the removed compartment with linessimilar to those in the plot_infection. The vertical lines are identical, but thehorizontal mean and median correspond to the posterior mean and median of theremoved process tR. An additional line indicates the estimated death prevalencefrom the input death_in_R.spaghetti_plot 20 randomly selected MCMC draws of the first-order derivative of the posteriorprevalence of infection, namely _I . The black curve is the posterior mean oftthe derivative, and the vertical lines mark times of turning points correspondingrespectively to those shown in plot_infection and plot_removed. Moreover,the 95% credible intervals of these turning points are also highlighted bysemitransparent rectangles.the date t at which \u007ftI = 0, calculated as the average of the time points withmaximum posterior first-order derivatives _tI ; this value may be slightly differentfrom the one labeled by the \"darkgreen\" lines in the two plots plot_infectionand plot_removed, which indicate the stationary point such that the first-orderderivative of the averaged posterior of tI reaches its maximum.the date t at which \u007ftI = 0, calculated as the average of the time points withmaximum posterior first-order derivatives _tI ; this value may be slightly differentfrom the one labeled by the \"darkgreen\" lines in the two plots plot_infectionand plot_removed, which indicate the stationary point such that the first-orderderivative of the averaged posterior of tI reaches its maximum.fwith first_tp_mean, it reports the corresponding credible interval and median.second_tp_mean the date t at which tI = 0, calculated as the average of the stationary pointsof all of posterior first-order derivatives _tI ; this value may be slightly differentfrom the one labeled by the \"pruple\" lines in the plots of plot_infection andtvt.eSIRplot_removed. The latter indicate stationary t at which the first-order derivativeof the averaged posterior of tI equals zero.with second_tp_mean, it reports the corresponding credible interval andmedian.the output of dic.sample() in dic.sample, computing deviance informationcriterion for model comparison.NI_complete <- c( 41,41,41,45,62,131,200,270,375,444,549, 729,1052,1423,2714,3554,4903,5806,7153,9074,11177,13522,16678,19665,22112,24953,27100,29631,31728,33366)RI_complete <- c(1,1,7,10,14,20,25,31,34,45,55,71,94,121,152,213,252,345,417,561,650,811,1017,1261,1485,1917,2260,2725,3284,3754)N=58.5e6R <- RI_complete/NY <- NI_complete/N- R #Jan13->Feb 11change_time <- c(\"01/23/2020\",\"02/04/2020\",\"02/08/2020\")phi0 <- c(0.1,0.4,0.4)res.q <- qh.eSIR (Y,R,begin_str=\"01/13/2020\",death_in_R = 0.4,phi0=phi0,change_time=change_time,casename=\"Hubei_q\",save_files = T,save_mcmc = F,M=5e2,nburnin = 2e2)res.q$plot_infection#res.q$plot_removedres.noq <- qh.eSIR (Y,R,begin_str=\"01/13/2020\",death_in_R = 0.4,T_fin=200,casename=\"Hubei_noq\",M=5e2,nburnin = 2e2)res.noq$plot_infectionFit extended state-space SIR model with time-varying transmissionratessecond_tp_ciFit extended state-space SIR model with prespecified changes in the transmission rate, eitherstepwise or continuous, accomodating time-varying quaratine protocols.tvt.eSIR(Y, R, pi0 = NULL, change_time = NULL, exponential = FALSE,lambda0 = NULL, begin_str = \"01/13/2020\", T_fin = 200,nchain = 4, nadapt = 10000, M = 500, thn = 10, nburnin = 200,dic = FALSE, death_in_R = 0.02, beta0 = 0.2586, gamma0 = 0.0821,R0 = beta0/gamma0, gamma0_sd = 0.1, R0_sd = 1,casename = \"tvt.eSIR\", file_add = character(0), save_files = FALSE,save_mcmc = FALSE, save_plot_data = FALSE)ArgumentsY the time series of daily observed infected compartment proportions.R the time series of daily observed removed compartment proportions, includingdeath and recovered.pi0 the time-dependent transission rate modifier (t) between 0 and 1.change_time the change points over time for step function pi, defalt value is NULL.exponential logical, whether (t) is exponential exp( 0t) or not; the default is FALSE.lambda0 the rate of decline in the exponential survival function in exp( 0t).begin_str the character of starting time, the default is \"01/13/2020\".T_fin the end of follow-up time after the beginning date begin_str, the default is 200.nchain the number of MCMC chains generated by rjags, the default is 4.nadapt the iteration number of adaptation in the MCMC. We recommend using at leastthe default value 1e4 to obtained fully adapted chains.M the number of draws in each chain, with no thinning. The default is M=5e2 butsuggest using 5e5.thn the thinning interval between mixing. The total number of draws thus wouldbecome round(M/thn)*nchain. The default is 10.nburnin the burn-in period. The default is 2e2 but suggest 2e5.dic logical, whether compute the DIC (deviance information criterion) for modelselection.death_in_R the numeric value of average of cumulative deaths in the removedcompartments. The default is 0.4 within Hubei and 0.02 outside Hubei.beta0 the hyperparameter of average transmission rate, the default is the one estimatedfrom the SARS first-month outbreak (0.2586).gamma0 the hyperparameter of average removed rate, the default is the one estimatedfrom the SARS first-month outbreak (0.0821).R0 the hyperparameter of the mean reproduction number R0. The default is thusthe ratio of beta0/gamma0, which can be specified directly.gamma0_sd the standard deviation for the prior distrbution of the removed rate , the defaultis 0.1.        R0_sd the standard deviation for the prior disbution of R0, the default is 1.casename the string of the job\u2019s name. The default is \"tvt.eSIR\".file_add the string to denote the location of saving output files and tables.save_files logical, whether save (TRUE) results or not (FALSE). This enables to savesummary tables, trace plots, and plots of the posterior means of the first-orderderivatives of the infection prevalence process tI .save_mcmc logical, whether save (TRUE) all the MCMC outputs or not (FALSE).Theoutput file will be an .RData file named by the casename. We include arraysof prevalence values of the three compartments with their matrices ofposterior draws up to the last date of the collected data as theta_p[        save_plot_data logical, whether save the plotting data or not.tvt.eSIRWe fit a state-space model with extended SIR, in which a time-varying transmission rate modifier(t) (between 0 and 1) is introcuded to model. This allows us to accommodate quarantine protocolchanges and ignored resources of hospitalization. The form of reducing rate may be a step-functionwith jomps at times of big policy changes or a smooth exponential survival function exp( 0t).The parameters of the function and change points, if any, should be predefined.the predefined casename.incidence_mean mean incidence.summary tables including the posterior mean of the prevalance processes of the3 states compartments ( tS ; tI ; tR) at last date of data collected ((t0) decided bythe lengths of your input data Y and R), and their respective credible inctervals(ci); the respective means and ci\u2019s of the reporduction number (R0), removedrate ( ), transmission rate ( ).plot_infection plot of summarizing and forecasting for the infection compartment, in whichthe vertial blue line denotes the last date of data collected (t0), the vertialdarkgray line denotes the deacceleration point (first turning point) that the posteriormean first-derivative of infection prevalence _tI achieves the maximum, thevertical purple line denotes the second turning point that the posterior meanfirstderivative infection proportion _tI equals zero, the darkgray line denotes theposterior mean of the infection prevalence tI and the red line denotes its posteriormedian.plot of summarizing and forecasting for the removed compartment with linessimilar to those in the plot_infection. The vertical lines are identical, but thehorizontal mean and median correspond to the posterior mean and median of theremoved process tR. An additional line indicates the estimated death prevalencefrom the input death_in_R.spaghetti_plot 20 randomly selected MCMC draws of the first-order derivative of the posteriorprevalence of infection, namely _I . The black curve is the posterior mean oftthe derivative, and the vertical lines mark times of turning points correspondingrespectively to those shown in plot_infection and plot_removed. Moreover,the 95% credible intervals of these turning points are also highlighted bysemitransparent rectangles.the date t at which \u007ftI = 0, calculated as the average of the time points withmaximum posterior first-order derivatives _tI ; this value may be slightly differentfrom the one labeled by the \"darkgreen\" lines in the two plots plot_infectionand plot_removed, which indicate the stationary point such that the first-orderderivative of the averaged posterior of tI reaches its maximum.fwith first_tp_mean, it reports the corresponding credible interval and median.second_tp_mean the date t at which tI = 0, calculated as the average of the stationary pointsof all of posterior first-order derivatives _tI ; this value may be slightly differentfrom the one labeled by the \"pruple\" lines in the plots of plot_infection andplot_removed. The latter indicate stationary t at which the first-order derivativeof the averaged posterior of tI equals zero.with second_tp_mean, it reports the corresponding credible interval andmedian.the output of dic.sample() in dic.sample, computing deviance informationcriterion for model comparison.### continuous exponential function of pi(t)res.exp <- tvt.eSIR(Y,R,begin_str=\"01/13/2020\",death_in_R = 0.4,T_fin=200,exponential=TRUE,dic=F,lambda0=0.05,casename=\"Hubei_exp\",save_files = F,save_mcmc=F,M=5e2,nburnin = 2e2)res.exp$plot_infection#res.exp$plot_removed### without pi(t), the standard state-space SIR model without interventionres.nopi <- tvt.eSIR(Y,R,begin_str=\"01/13/2020\",death_in_R = 0.4,T_fin=200,casename=\"Hubei_nopi\",save_files = F,M=5e2,nburnin = 2e2)res.nopi$plot_infection#res.nopi$plot_removedIndexdic.sample, 4, 7qh.eSIR, 1tvt.eSIR, 4", "ref_list": [[], ["Extended state-space SIR models"], ["and David S Sto er. A monte carlo approach to nonnormal and nonlinear state-space modeling"], ["Clinical characteristics and intrauterine vertical transmission potential of covid-19 infection in nine pregnant women: a retrospective review of medical records"], ["Plague manual: epidemiology, distribution, surveillance and control"], ["Bat coronaviruses in china"], ["Return of the coronavirus: 2019-ncov"], ["Zheng-yi Ni, Yu Hu, Wen-hua Liang, Chun-quan Ou, Jian-xing He"], ["First case of 2019 novel coronavirus in the united states"], ["Arti cial intelligence forecasting of covid-19 in china"], ["Clinical features of patients infected with 2019 novel coronavirus in wuhan, china"], ["The continuing 2019-ncov epidemic threat of novel coronaviruses to global health|the latest 2019 novel coronavirus outbreak in wuhan, china"], ["Estimating the potential total number of novel coronavirus cases in wuhan city"], ["PX-K Song,"], ["Stationary state space models for longitudinal data"], ["Real-time estimation of the risk of death from novel coronavirus (covid-19) infection: Inference using exported cases"], ["A contribution to the mathematical theory of epidemics"], ["Estimation of the epidemic properties of the 2019 novel coronavirus: A mathematical modeling study"], ["Trend and forecasting of the covid-19 outbreak in china"], ["Assessing the tendency of 2019-ncov (covid-19) outbreak in china"], ["Xin Li, Joshua Fung, Susanna KP Lau, and Patrick CY Woo"], ["Modeling super-spreading events for infectious diseases: case study sars"], ["Transmission of 2019-ncov infection from an asymptomatic contact in germany"], [""], ["Estimation of the reproductive number of novel coronavirus (covid-19) and the probable outbreak size on the diamond princess cruise ship: A data-driven analysis"], ["A novel coronavirus from patients with pneumonia in china"], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []], "ref_authors": [[], ["Song Lab"], ["P Carlin Bradley"], ["Huijun Chen", "Dongchi Zhao", "Qing Gong"], ["David T Dennis", "Jack D Poland"], ["Yi Fan", "Kai Zhao", "and Peng Zheng-Li Shi", "Zhou"], ["E Lisa", "Gralinski and Vineet D Menachery"], ["Wei-jie Guan", "Lei"], ["L Holshue Michelle", "DeBolt Chas", "Ahmet Kathy H Lofy", "Tural"], ["Zixin Hu", "Li Jin", "Momiao Xiong"], ["Huang Chaolin", "Wang Yeming", "Xingwang Li", "Lili Ren", "Jianping Zhao", "Yi Hu", "Xiaoying Gu"], ["S Hui David", "Esam I Azhar Timothy D Mchugh", "Ziad A Memish", "Christian Drosten"], ["Imai Natsuko", "Neil M Ferguson."], ["J rgensen Bent", "Li Sun"], ["Bent J srgensen and Peter X-K Song"], ["Yichi Sung-mok Jung", "Hiroshi Yang", "Nishiura"], ["William Ogilvy Kermack and Anderson G McKendrick"], ["Jinghua Li", "Yijing Wang", "Liping Peng"], ["Qiang Li", "Wei Feng"], ["Liu Qinghe", "Deqiang Li", "Zefei Gao", "Junyan Yang", "Qiao Wang"], ["KH Luk Hayes"], ["Thembinkosi Mkhatshwa", "Anna Mummert"], ["Rothe Camilla", "Peter Sothmann", "Wolfgang Guggemos"], ["Guangchuang Yu"], ["Zhang Sheng", "Zhaofen Lin", "Dechang Chen"], ["Zhu Na", "Xingwang Li", "Bo Yang", "Xiang Zhao", "Baoying Huang", "Roujian Lu"], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []], "fir_para": "\n        The outbreak of the coronavirus disease or COVID-19, originated in Wuhan, the capital city of\nHubei province, spreads out quickly in Hubei and then in China, South Korea, Japan, Iran and\nItaly, as well as many other cities across the world. Being one of the great epidemics in the 21st\ncentury, till February 25, 2020, in China it has caused a total of 78,195 con rmed infections, 2,718\ndeaths and 30,078 recovered cases, and 2,491 suspected cases still remained to be tested. Since the\noutbreak of the epidemic, many clinical papers [\n        ", "one_words_summarize": "The outbreak of the coronavirus disease or COVID-19, originated in Wuhan, the capital city ofHubei province, spreads out quickly in Hubei and then in China, South Korea, Japan, Iran andItaly, as well as many other cities across the world. This dynamic infection systemnecessitates the forecast of the future trend of COVID-19 spread. Section 2 presents our new epidemiological forecast model incorporatingtimevarying quarantine protocols. Section 3 concerns the algorithmic implementation via Markov ChainMonte Carlo and a deliverable R software. This framework was proposed by [23] with onlyonedimensional time series of infected proportions. Following [23], we invoke the fourth-order Runge{Kutta(RK4) approximation, resulting inan approximate of f p t 1; ; q as follows:kS4            t 1sktI4 1skR4t 1s;where all these kt terms are given in the appendix A. Denote the set of model parameters byp ; ; 0; ; qJ, which will be estimated using the MCMC method [            The basic epidemiological model with both constant transmission and removal rates in SIR model(4) does not re ect the reality in China, where all levels of quarantines have been enforced. In addition, the virus itself maymutate to evolve, so to increase the potential rate of false negative in the disease diagnosis. See the detailed in Section 3.2.3An alternative way to incorporate quarantine measures into the basic epidemiological model (4) isto add a new quarantine compartment that collects quarantined individuals who would have nochance of meeting any infected individuals in the infection system, as shown in Figure 5. Note that at each jump, therespective proportion of the susceptible population would move to the quarantine compartment. The R package rjags[25] can be directly applied to draw samples from the posterior distributions, so we omit thetechnical details. Mathematically, this corresponds to the time t at which :tI 0 or the gradient of 9tIis zero. In principle, the second turning point occursonly after the rst one, as shown in Panel B in Figure 7.The reproduction number R0 of an infectious disease is estimated by the ratio R0 { , whereand are both estimated from their posterior distributions. Weadopt a standard MCMC algorithm to draw the latent process. Moreover,the package gives multiple options to users who can save the entire MCMC results, including theoutput tables and summary plots, traceplots for MCMC quality control, and full MCMC drawsfor user's own summary analyses. We assume an exponential growth curve for the cumulative number of infected cases in Hubeibefore Feb 12 of the form yptq ae t b, where parameters ; a; b are to be estimated. According to an existing R package on GitHub GuangchuangYu/nCov2019[          First, we show the analysis of the Hubei COVID-19 data. In the package, function tvt.eSIR() works on the epidemiological model withtimevarying transmission rate in Section 2.2, and qh.eSIR() for the other epidemiological model witha quarantine compartment in Section 2.3. The gray and red curves are the posterior mean and median curves. The black curve inthe plot (Panel C) is the proportion of deaths estimated from a pre-speci ed ratio death_in_R. Themiddle Panel B displays important dynamic features of the infection via a spaghetti plot, in which 20randomly selected MCMC draws of the rst-order derivative of the posterior prevalence of infection,namely 9tI . To address the delayedstarting time, we included two change points for the step function ptq at [Feb 4, Feb 8] with0 p0:8; 0:1q. The other epidemiological model with an added quarantine compartment as an absorbing statewas tted via our R function qh.eSIR in the package eSIR. Note that if the quarantine rate function is set at constant0, this model will be reduced to a basic epidemiological SIR model.### It is evident that by Feb 8, more than 90% of theChinese population have taken in-home isolation or as such, re ective to a very strict quarantineprotocol enforced in the entire country. These ndingsare in agreement with ndings from [            We develop an epidemiological forecast model with an R software package to assess e ects ofinterventions on the COVID-19 epidemic within Hubei and outside Hubei in China. Summary of probable sars cases with onset ofillness from 1 november 2002 to 31 july 2003. Correlated Data Analysis: Modeling, Analytics, and Applications. Monte carlo kalman lter and smoothing for multivariate discrete statespace models. Canadian Journal of Statistics, 28(3):641{652, 2000.[32] Lorenzo Subissi, Clara C Posthuma, Axelle Collet, Jessika C Zevenhoven-Dobbe, Alexander Eacute respiratory syndrome coronavirus protein complex integrates processive rna polymeraseand exonuclease activities. Proceedings of the National Academy of Sciences, 111(37):E3900{E3909, 2014.[33] Haoxuan Sun, Yumou Qiu, Han Yan, Yaxuan Huang, Yuru Zhu, and Song Xi Chen. medRxiv, 2020.[34] Chen Wang, Peter W Horby, Frederick G Hayden, and George F Gao. Signal extraction and breakpointidentication for array cgh data using robust state space model. The optimization problem can be solved using themethod of Lagrange Multipliers. .tvt.eSIR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . The default is M=5e2 butsuggest using 5e5.the thinning interval between mixing. The vertical lines are identical, but thehorizontal mean and median correspond to the posterior mean and median of theremoved process tR. An additional line indicates the estimated death prevalencefrom the input death_in_R.spaghetti_plot 20 randomly selected MCMC draws of the first-order derivative of the posteriorprevalence of infection, namely _I . T_fin the end of follow-up time after the beginning date begin_str, the default is 200.nchain the number of MCMC chains generated by rjags, the default is 4.nadapt the iteration number of adaptation in the MCMC. We recommend using at leastthe default value 1e4 to obtained fully adapted chains."}